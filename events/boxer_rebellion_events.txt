namespace = boxer_rebellion_events

# The Yihetuan Movement
boxer_rebellion_events.1 = {
	type = country_event
	placement = ROOT
	
	title = boxer_rebellion_events.1.t
	desc = boxer_rebellion_events.1.d
	flavor = boxer_rebellion_events.1.f
	
	duration = 3
	
	event_image = {
		video = "asia_union_leader"
	}
	
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_fire.dds"
	
	trigger = {	# Triggered by JE
		}
	
	immediate = {
		cu:han = {
			save_scope_as = han_culture
		}
		cu:manchu = {
			save_scope_as = manchu_culture
		}
	}
	option = {
		name = boxer_rebellion_events.1.a
		every_country = {
			limit = {
				any_scope_state = {
					state_region = {
						is_homeland = cu:han
					}
				}
				NOR = {
					owner = ROOT
					country_has_primary_culture = cu:manchu
					country_has_primary_culture = cu:han
				}
			}
			change_relations = {
				country = ROOT
				value = -100
			}
		}
		if = {
			limit = {
				any_scope_pop = {
					religion = rel:protestant
				}
			}
			add_radicals = {
				religion = rel:protestant
				value = very_large_radicals
			}
		}
		if = {
			limit = {
				any_scope_pop = {
					religion = rel:catholic
				}
			}
			add_radicals = {
				religion = rel:catholic
				value = very_large_radicals
			}
		}
		if = {
			limit = {
				any_scope_pop = {
					religion = rel:orthodox
				}
			}
			add_radicals = {
				religion = rel:orthodox
				value = very_large_radicals
			}
		}
		add_radicals = {
			value = large_radicals
			culture = cu:han
		}
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = boxer_rebellion_events.1.b
		default_option = yes
		every_country = {
			limit = {
				any_scope_state = {
					state_region = {
						is_homeland = cu:han
					}
				}
				NOR = {
					owner = ROOT
					country_has_primary_culture = cu:manchu
					country_has_primary_culture = cu:han
				}
			}
			change_relations = {
				country = ROOT
				value = 20
			}
		}
		add_radicals = {
			value = very_large_radicals
			culture = cu:han
		}
		ai_chance = {
			base = 0
		}
	}
}

# The Mandate of Heaven
boxer_rebellion_events.2 = {
	type = country_event
	placement = ROOT
	
	title = boxer_rebellion_events.2.t
	desc = boxer_rebellion_events.2.d
	flavor = boxer_rebellion_events.2.f
	
	duration = 3
	
	gui_window = event_window_1char_tabloid
	
	left_icon = root.ruler
	
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"
	
	icon = "gfx/interface/icons/event_icons/event_portrait.dds"
	
	trigger = {}
	
	immediate = {}
	
	option = {
		name = boxer_rebellion_events.2.a
		default_option = yes
		add_loyalists = {
			value = 0.2
			culture = cu:han
		}
		add_modifier = {
			name = revere_the_emperor
			days = long_modifier_time
		}
		hidden_effect = { post_notification = warlord_china_explosion_point_remove }
		set_variable = won_boxer_rebellion
	}
	option = {
		name = boxer_rebellion_events.2.b
		add_loyalists = {
			value = 0.2
			culture = cu:han
		}
		add_modifier = {
			name = united_in_righteousness
			days = long_modifier_time
		}
		hidden_effect = { post_notification = warlord_china_explosion_point_remove }
		set_variable = won_boxer_rebellion
	}
}

# Boxer Rebellion Failure / time-out
boxer_rebellion_events.3 = {
	type = country_event
	placement = ROOT
	
	title = boxer_rebellion_events.3.t
	desc = boxer_rebellion_events.3.d
	flavor = boxer_rebellion_events.3.f
	
	duration = 3
	
	event_image = {
		video = "asia_union_leader"
	}
	
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	
	minor_left_icon = c:CHI
	
	trigger = {}
	
	immediate = {
		set_variable = je_boxer_rebellion_timed_out	# This adds 20 fragile unity to the Qing, set in the scripted_value imperia_qing_fragile_unity_value
	}
	
	option = {
		name = boxer_rebellion_events.3.a
		default_option = yes
		remove_modifier ?= qing_reforms_hundred_days_reform_failure	# Remove the Hundred Days Reform failure modifier if it exists
		add_modifier = {	# Add the Dynasty is Finished modifier
			name = qing_boxer_rebellion_dynasty_is_finished
			years = 20
		}
		if = {	# If Cixi is alive, make her a modernizer leader
			limit = {
				any_scope_character = {
					has_template = chi_cixi_template
				}
			}
			random_scope_character = {
				limit = {
					has_template = chi_cixi_template
				}
				set_ideology = ideology:ideology_modernizer_leader
				set_as_interest_group_leader = yes
			}
		}
		else = {	# Else just spawn here in, could get weird though depending on the date....
			create_character = {
				template = chi_cixi_template
				ideology = ideology_modernizer_leader
				ig_leader = yes
			}
		}
		if = {	# If there is no radical movement, create one
			limit = {
				NOT = {
					any_political_movement = {
						is_political_movement_type = movement_radical
					}
				}
			}
			create_political_movement = { type = movement_radical }
		}
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = boxer_rebellion_events.3.b
		activate_law = law_type:law_presidential_republic	# Switch to Republic
		if = {	# If Yuan Shikai is alive, make him IG leader and ruler
			limit = {
				any_scope_character = {
					has_template = chi_general_yuan_shikai
				}
			}
			random_scope_character = {
				limit = {
					has_template = chi_general_yuan_shikai
				}
				set_as_interest_group_leader = yes
				set_character_as_ruler = yes
			}
		}
		else = {	# Else just spawn him in
			create_character = {
				template = chi_general_yuan_shikai
				ig_leader = yes
				ruler = yes
			}
		}
		ai_chance = {
			base = 0
		}
	}
}

# The Fall of the Qing Dynasty (I think this event is unused?)
boxer_rebellion_events.4 = {
	type = country_event
	placement = ROOT
	
	title = boxer_rebellion_events.4.t
	desc = boxer_rebellion_events.4.d
	flavor = boxer_rebellion_events.4.f
	
	duration = 3
	
	event_image = {
		video = "asia_farmers_market"
	}
	
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	
	icon = "gfx/interface/icons/event_icons/event_protest.dds"
	
	trigger = {
		NOT = {
			has_variable = china_han_empire
		}
	}
	
	immediate = {
		cu:manchu = {
			save_scope_as = manchu_culture
		}
	}
	option = {
		name = boxer_rebellion_events.4.a
		default_option = yes
		
		hidden_effect = {
			post_notification = warlord_china_explosion_point_add
		}
		change_variable = {
			name = china_warlord_explosion
			add = 1
		}
		if = {
			limit = {
				NOT = { country_has_primary_culture = cu:han }
			}
			add_primary_culture = cu:han
		}
		remove_primary_culture = cu:manchu
		set_variable = china_han_empire
		add_radicals = {
			value = very_large_radicals
			culture = cu:manchu
		}
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = boxer_rebellion_events.4.b
		if = {
			limit = {
				NOT = { country_has_primary_culture = cu:han }
			}
			add_primary_culture = cu:han
		}
		add_radicals = {
			value = very_large_radicals
			culture = cu:han
		}
		ai_chance = {
			base = 0
		}
	}
}
